<script>
  import {fade} from 'svelte/transition'
  import {IconButton} from '@components/buttons'
  import { createEventDispatcher } from 'svelte';
  const dispatch = createEventDispatcher();
  import {modal} from '@stores/app'
  import {content} from '@stores/data/page'

  let fullwidth = false
  let gapless = false

  $: sections = [
    [
      'w-full'
    ],
    [
      `w-full md:w-1/2 ${!gapless ? 'md:pr-3' : ''}`,
      `w-full md:w-1/2 ${!gapless ? 'md:pl-3' : ''}`
    ],
    [
      `w-full md:w-1/3 ${!gapless ? 'md:pr-3' : ''}`,
      `w-full md:w-1/3 ${!gapless ? 'md:px-3' : ''}`,
      `w-full md:w-1/3 ${!gapless ? 'md:pl-3' : ''}`
    ],
    [
      `w-full md:w-2/3 ${!gapless ? 'md:pr-3' : ''}`,
      `w-full md:w-1/3 ${!gapless ? 'md:pl-3' : ''}`
    ],
    [
      `w-full md:w-1/3 ${!gapless ? 'md:pr-3' : ''}`,
      `w-full md:w-2/3 ${!gapless ? 'md:pl-3' : ''}`
    ],
  ]

  function selectSection(columns) {
    content.insertSection({
      fullwidth,
      gapless,
      columns
    })
    modal.hide()
  }

</script>

<div class="buttons has-addons is-fullwidth">
  <button on:click={() => fullwidth = !fullwidth} class="button is-expanded" type="checkbox" class:is-link={fullwidth}>Fullwidth</button>
  <button on:click={() => gapless = !gapless} class="button is-expanded" type="checkbox" class:is-link={gapless}>Gapless</button>
</div>
{#each sections as columns}
  <article class="message component-wrapper" transition:fade={{ delay: 250, duration: 200 }}>
    <div class="message-header">
      <p class="component-label"></p>
      <div class="buttons">
        <IconButton variants="is-small is-link" icon="plus-circle" on:click={() => selectSection(columns)}/>  
      </div>
    </div>
    <div class="message-body" class:fullwidth>
      <div class="flex flex-wrap" class:is-gapless={gapless}>
        {#each columns as column}
          <div class="column {column}">
            <div class="placeholder"></div>
          </div>
        {/each}
      </div>
    </div>
  </article>
{/each}


<style>
  .fullwidth {
    padding: 1.25em 0 !important;
    transition: padding 0.25s;
  }
  .fullwidth .column:first-child {
    @apply pl-0;
  }
  .fullwidth .column:last-child {
    @apply pr-0;
  }
  .message-body {
    transition: padding 0.25s;
  }
  .placeholder {
    @apply bg-primored;
    height: 2rem;
  }
  .columns {
    margin: 0 !important;
  }
  .is-gapless>.column {
    transition: padding 0.25s;
    border-left: 1px solid whitesmoke;
    border-right: 1px solid whitesmoke;
    padding: 0;
  }
  .is-gapless>.column:last-child {
    border-right: 0;
  }
  .is-gapless>.column:first-child {
    border-left: 0;
  }
  .column {
    transition: padding 0.25s;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
  }
</style>