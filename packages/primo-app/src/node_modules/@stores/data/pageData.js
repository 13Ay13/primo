import { writable, readable, derived, get } from 'svelte/store';
import { site } from '@stores/data'

const store = writable({
  id: '',
  title: '',
  content: '',
  dependencies: {
    headEmbed: '',
    libraries: []
  },
  styles: {
    raw: '',
    final: '',
    tailwind: ''
  }
})

store.subscribe(s => {
  if (s && site) {
    site.pages.modify(s)
  }
})

export default {
  save: (property, value) => {
    store.update(s => ({
      ...s, 
      [property]: value
    }))
  },
  saveStyles: (styles) => {
    store.update(s => ({
      ...s, 
      styles
    }))
  },
  subscribe: store.subscribe,
  set: store.set
}