{"version":3,"file":"xml-fold.js","sources":["../node_modules/codemirror/addon/fold/xml-fold.js"],"sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var Pos = CodeMirror.Pos;\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch; }\n\n  var nameStartChar = \"A-Z_a-z\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD\";\n  var nameChar = nameStartChar + \"\\-\\:\\.0-9\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040\";\n  var xmlTagStart = new RegExp(\"<(/?)([\" + nameStartChar + \"][\" + nameChar + \"]*)\", \"g\");\n\n  function Iter(cm, line, ch, range) {\n    this.line = line; this.ch = ch;\n    this.cm = cm; this.text = cm.getLine(line);\n    this.min = range ? Math.max(range.from, cm.firstLine()) : cm.firstLine();\n    this.max = range ? Math.min(range.to - 1, cm.lastLine()) : cm.lastLine();\n  }\n\n  function tagAt(iter, ch) {\n    var type = iter.cm.getTokenTypeAt(Pos(iter.line, ch));\n    return type && /\\btag\\b/.test(type);\n  }\n\n  function nextLine(iter) {\n    if (iter.line >= iter.max) return;\n    iter.ch = 0;\n    iter.text = iter.cm.getLine(++iter.line);\n    return true;\n  }\n  function prevLine(iter) {\n    if (iter.line <= iter.min) return;\n    iter.text = iter.cm.getLine(--iter.line);\n    iter.ch = iter.text.length;\n    return true;\n  }\n\n  function toTagEnd(iter) {\n    for (;;) {\n      var gt = iter.text.indexOf(\">\", iter.ch);\n      if (gt == -1) { if (nextLine(iter)) continue; else return; }\n      if (!tagAt(iter, gt + 1)) { iter.ch = gt + 1; continue; }\n      var lastSlash = iter.text.lastIndexOf(\"/\", gt);\n      var selfClose = lastSlash > -1 && !/\\S/.test(iter.text.slice(lastSlash + 1, gt));\n      iter.ch = gt + 1;\n      return selfClose ? \"selfClose\" : \"regular\";\n    }\n  }\n  function toTagStart(iter) {\n    for (;;) {\n      var lt = iter.ch ? iter.text.lastIndexOf(\"<\", iter.ch - 1) : -1;\n      if (lt == -1) { if (prevLine(iter)) continue; else return; }\n      if (!tagAt(iter, lt + 1)) { iter.ch = lt; continue; }\n      xmlTagStart.lastIndex = lt;\n      iter.ch = lt;\n      var match = xmlTagStart.exec(iter.text);\n      if (match && match.index == lt) return match;\n    }\n  }\n\n  function toNextTag(iter) {\n    for (;;) {\n      xmlTagStart.lastIndex = iter.ch;\n      var found = xmlTagStart.exec(iter.text);\n      if (!found) { if (nextLine(iter)) continue; else return; }\n      if (!tagAt(iter, found.index + 1)) { iter.ch = found.index + 1; continue; }\n      iter.ch = found.index + found[0].length;\n      return found;\n    }\n  }\n  function toPrevTag(iter) {\n    for (;;) {\n      var gt = iter.ch ? iter.text.lastIndexOf(\">\", iter.ch - 1) : -1;\n      if (gt == -1) { if (prevLine(iter)) continue; else return; }\n      if (!tagAt(iter, gt + 1)) { iter.ch = gt; continue; }\n      var lastSlash = iter.text.lastIndexOf(\"/\", gt);\n      var selfClose = lastSlash > -1 && !/\\S/.test(iter.text.slice(lastSlash + 1, gt));\n      iter.ch = gt + 1;\n      return selfClose ? \"selfClose\" : \"regular\";\n    }\n  }\n\n  function findMatchingClose(iter, tag) {\n    var stack = [];\n    for (;;) {\n      var next = toNextTag(iter), end, startLine = iter.line, startCh = iter.ch - (next ? next[0].length : 0);\n      if (!next || !(end = toTagEnd(iter))) return;\n      if (end == \"selfClose\") continue;\n      if (next[1]) { // closing tag\n        for (var i = stack.length - 1; i >= 0; --i) if (stack[i] == next[2]) {\n          stack.length = i;\n          break;\n        }\n        if (i < 0 && (!tag || tag == next[2])) return {\n          tag: next[2],\n          from: Pos(startLine, startCh),\n          to: Pos(iter.line, iter.ch)\n        };\n      } else { // opening tag\n        stack.push(next[2]);\n      }\n    }\n  }\n  function findMatchingOpen(iter, tag) {\n    var stack = [];\n    for (;;) {\n      var prev = toPrevTag(iter);\n      if (!prev) return;\n      if (prev == \"selfClose\") { toTagStart(iter); continue; }\n      var endLine = iter.line, endCh = iter.ch;\n      var start = toTagStart(iter);\n      if (!start) return;\n      if (start[1]) { // closing tag\n        stack.push(start[2]);\n      } else { // opening tag\n        for (var i = stack.length - 1; i >= 0; --i) if (stack[i] == start[2]) {\n          stack.length = i;\n          break;\n        }\n        if (i < 0 && (!tag || tag == start[2])) return {\n          tag: start[2],\n          from: Pos(iter.line, iter.ch),\n          to: Pos(endLine, endCh)\n        };\n      }\n    }\n  }\n\n  CodeMirror.registerHelper(\"fold\", \"xml\", function(cm, start) {\n    var iter = new Iter(cm, start.line, 0);\n    for (;;) {\n      var openTag = toNextTag(iter)\n      if (!openTag || iter.line != start.line) return\n      var end = toTagEnd(iter)\n      if (!end) return\n      if (!openTag[1] && end != \"selfClose\") {\n        var startPos = Pos(iter.line, iter.ch);\n        var endPos = findMatchingClose(iter, openTag[2]);\n        return endPos && cmp(endPos.from, startPos) > 0 ? {from: startPos, to: endPos.from} : null\n      }\n    }\n  });\n  CodeMirror.findMatchingTag = function(cm, pos, range) {\n    var iter = new Iter(cm, pos.line, pos.ch, range);\n    if (iter.text.indexOf(\">\") == -1 && iter.text.indexOf(\"<\") == -1) return;\n    var end = toTagEnd(iter), to = end && Pos(iter.line, iter.ch);\n    var start = end && toTagStart(iter);\n    if (!end || !start || cmp(iter, pos) > 0) return;\n    var here = {from: Pos(iter.line, iter.ch), to: to, tag: start[2]};\n    if (end == \"selfClose\") return {open: here, close: null, at: \"open\"};\n\n    if (start[1]) { // closing tag\n      return {open: findMatchingOpen(iter, start[2]), close: here, at: \"close\"};\n    } else { // opening tag\n      iter = new Iter(cm, to.line, to.ch, range);\n      return {open: here, close: findMatchingClose(iter, start[2]), at: \"open\"};\n    }\n  };\n\n  CodeMirror.findEnclosingTag = function(cm, pos, range, tag) {\n    var iter = new Iter(cm, pos.line, pos.ch, range);\n    for (;;) {\n      var open = findMatchingOpen(iter, tag);\n      if (!open) break;\n      var forward = new Iter(cm, pos.line, pos.ch, range);\n      var close = findMatchingClose(forward, open.tag);\n      if (close) return {open: open, close: close};\n    }\n  };\n\n  // Used by addon/edit/closetag.js\n  CodeMirror.scanForClosingTag = function(cm, pos, name, end) {\n    var iter = new Iter(cm, pos.line, pos.ch, end ? {from: 0, to: end} : null);\n    return findMatchingClose(iter, name);\n  };\n});\n"],"names":["CodeMirror","Pos","a","b","line","ch","nameStartChar","xmlTagStart","RegExp","cm","range","text","getLine","min","Math","max","from","firstLine","to","lastLine","iter","type","getTokenTypeAt","test","length","gt","indexOf","nextLine","tagAt","lastSlash","lastIndexOf","selfClose","slice","lt","prevLine","lastIndex","match","exec","index","found","tag","stack","end","next","toNextTag","startLine","startCh","toTagEnd","i","push","prev","toPrevTag","endLine","endCh","start","toTagStart","registerHelper","Iter","openTag","startPos","endPos","findMatchingClose","cmp","findMatchingTag","pos","here","open","close","at","findMatchingOpen","findEnclosingTag","scanForClosingTag","name","require$$0"],"mappings":"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"}