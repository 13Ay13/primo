<script>
  import { onMount, createEventDispatcher } from 'svelte'
  const dispatch = createEventDispatcher() 

  let firebase
  onMount(async() => {
		const {firebase} = await import('@firebase/app');
    firebaseCore.set(firebase)

    await import("firebase/auth")
    await import("firebase/firestore")
    await import("firebase/storage")

    const firebaseConfig = {
      apiKey: "AIzaSyBVh2V0MgMfHY8O_-etZBdtQ14YWdVLxBo",
      authDomain: "primo-d4041.firebaseapp.com",
      databaseURL: "https://primo-d4041.firebaseio.com",
      projectId: "primo-d4041",
      storageBucket: "primo-d4041.appspot.com",
      messagingSenderId: "420475988953",
      appId: "1:420475988953:web:84d3a91901440ac3ab47c8",
      measurementId: "G-C6RSLQN5W4"
    };
    // Initialize Firebase if not already initialized (like when navigating to new primo page)
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
      firebaseApp.set(firebase)
    }

    dispatch('load')
  })

</script>

<script context="module">
  import {writable} from 'svelte/store' 
  export const firebaseApp = writable(false)
  export const firebaseCore = writable(false)
</script>