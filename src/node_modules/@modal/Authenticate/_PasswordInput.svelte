<script>
  import {fade} from 'svelte/transition'
  import {warning, loading, password, resettingPassword} from './Authenticate.svelte'

  export let showTerms = false
  export let showReset = false
  export let tabindex;

  let accepted = false

  $: disabled = showTerms ? !accepted : false

</script>

<div class="password">
  <label class="label">Password</label>
  {#if showReset}
    <button class="button is-text is-small" on:click={() => resettingPassword.set(true)} type="button" tabindex={showReset ? tabindex+1 : tabindex}>reset password</button>
  {/if}
</div>
<div class="control">
  <input bind:value={$password} class="input is-medium" type="password" {tabindex}>
</div>
<br>
{#if $warning}
  <div class="notification is-warning" transition:fade>
    { $warning }
  </div>
{/if}
{#if showTerms}
  <label class="flex flex-row items-center justify-start mb-4">
    <input type="checkbox" class="mr-1" bind:checked={accepted} tabindex="{showReset ? tabindex+2 : tabindex+1}"/>
    <span class="text-sm">Do you accept primo's <a class="text-blue-600 underline" href="https://www.iubenda.com/terms-and-conditions/39882203" target="blank">terms and conditions</a>?</span>
  </label>
{/if}
<div class="field">
  <div class="control">
    <button class="button is-fullwidth is-link" type="submit" class:is-loading={$loading} {disabled} tabindex="{showTerms ? (showReset ? tabindex+3 : tabindex+2) : (showReset ? tabindex+2 : tabindex+1)}">Submit</button>
  </div>
</div>

<style>
  .password {
    display: flex;
    justify-content: space-between;
  }

</style>