<script>
  import {onMount} from 'svelte'
  import {fade} from 'svelte/transition'
  import {buildPagePreview,wrapInStyleTags} from 'utils'
  import {site,tailwind,pageData} from '@stores/data'

  export let page

  let preview = wrapInStyleTags($tailwind) + wrapInStyleTags($site.styles.final) + wrapInStyleTags($pageData.styles.final) + buildPagePreview(page)

  let iframeLoaded = false
</script>

<div class="page-preview">
  <iframe class:fadein={iframeLoaded} title="page preview" srcdoc={preview} on:load={() => {iframeLoaded = true }}></iframe>
</div>


<style>
  .page-preview {
    @apply relative overflow-hidden pointer-events-none;
    height: 15vh;
  }
  iframe {
    @apply opacity-0 transition-opacity duration-200;
    width: 50vw;
    transform: scale(0.205);
    transform-origin: top left;
    height: 1000vh;
  }
  .fadein {
    @apply opacity-100;
  }
</style>